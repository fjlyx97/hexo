---
title: 设计模式记录
date: 2020-07-30 16:32:10
tags:
- 学习
- 设计模式
categories : "设计模式"
---

> - 设计模式之美笔记
> - 基于极客时间专栏

<!-- more-->

# 常见的设计模式
## 创建型
单例模式、工厂模式（工厂方法，抽象工厂）、建造者模式
- 不常用：原型模式

## 结构型
代理模式、桥接模式、装饰者模式、适配器模式
- 不常用：门面模式、组合模式、享元模式

## 行为型
观察者模式，模板模式，策略模式，责任链模式，迭代器模式，状态模式
- 不常用：访问者模式，备忘录模式，命令模式，解释器模式，中介模式

# 里式原则
继承关系中，子类涉及要保证在替换父类时，不改变原有程序逻辑，不破坏原有程序的正确性

# 单例模式
目前大部分的单例模式，都是属于进程唯一的单例模式。

## 线程唯一
通过HashMap存储对象，Key是线程ID，Value是对象。Java当中存在ThreadLoacl，可以直接实现线程唯一单例。

## 集群唯一
将单例对象，序列化后存储到外部存储区（比如文件）。进程在读取这个单例模式的时候，从外部文件读取到内存，并反序列化成对象，然后在使用。用完后还要在存储为外部共享存储区。（需要用到分布式锁）

# 工厂模式
## DI容器
DI容器事先不知道应用会创建哪些对象，需要维护一个配置，来保存创建对象的必要信息。

# 建造者模式（Builder模式、生成器模式、构造者模式）
## 为什么要建造者模式
平时开发，使用New关键字调用类的构造函数就可以创建对象。但是会出现以下几个问题:
1. 构造函数的参数很多，容易搞错顺序
2. 配置项拥有一定的依赖关系，比如设置了（maxTotal,maxIdle,minIdle）中的一个，就必须设置另外两个参数。并且还需要一定的约束条件
3. 希望对象是不可变对象，对象创建好之后，就不能再修改内部的属性值

建造者模式就是为了解决这些问题。先创建建造者，再通过set方法设置建造者的值，再通过build()方法创建对象之前，做集中的校验，并且把构造函数修改为私有全校，这样就只能通过建造者来创建对象了。

- 实际上，如果不关心对象是否有短暂的无效状态，也不在意对象是否是可变的，就没必要用建造者模式

## 和工厂模式有何区别
工厂模式是用来创建不同，但是类型相关的对象。建造者是创建同一种类型的复杂对象。

# 原型模式